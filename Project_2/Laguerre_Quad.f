      Implicit Real*8(a-h,o-z)
      Dimension Xa(24),Wa(24)
!
      fi3s(ro)=2/sqrt(3d0)/81*(27-18*ro+2*ro**2)
!
      do n=4,24,4
         call Laguerre Q(n,Xa,Wa)
         write (6,1100) n,(Xa(i),Wa(i),i=1,n)
 1100 format(//'Quadrature à',i3,' points :'/(10x,2e25.17))
!     Vérification \int_0^\infty x^p.e^{-x}dx=p!
         sum=0d0
         r3s=0d0
         do m=1,n
!           sum=sum+wa(m)*dexp(-Xa(m))
            sum=sum+wa(m)*(Xa(m)**2-2*Xa(m)+3)
            ro=3*Xa(m)/2
            r3s=r3s+wa(m)*fi3s(ro)**2*ro**3
         enddo
         write (6,1110) sum
         write (6,1120) 3*r3s/2
 1110 format('Vérification :'e25.17,' vs. 3')
 1120 format('<r>_3s :'e25.17,' vs. 13.5')
      enddo
      end
      Subroutine Laguerre Q(nX,x_q,w_q)
!     Gauss-Laguerre quadrature for nX points(nX/4=1,6)
!     associated to the weight function W(x)=exp(-x)
      Implicit Real*8(a-h,o-z)
      Dimension x_q(nX),w_q(nX)
!     Local variables
      Dimension A(6,24),X(6,24)
     1,A1(19),A2(19),A3(19),A4(19),A5(19),A6(19),A7(19),A8(11)
     2,X1(19),X2(19),X3(19),X4(19),X5(19),X6(19),X7(19),X8(11)
      EQUIVALENCE (A(1),A1(1)),(A(20),A2(1)),(A(39),A3(1)),(A(58),A4(1))
     1,(A(77),A5(1)),(A(96),A6(1)),(A(115),A7(1)),(A(134),A8(1))
     2,(X(1),X1(1)),(X(20),X2(1)),(X(39),X3(1)),(X(58),X4(1))
     3,(X(77),X5(1)),(X(96),X6(1)),(X(115),X7(1)),(X(134),X8(1))
      DATA  X1     /              0.32254768961939230D+00
     1,  0.17027963230510100D+00, 0.11572211735802070D+00
     2,  0.87649410478927840D-01, 0.70539889691988760D-01
     3,  0.59019852181507980D-01, 0.17457611011583470D+01
     4,  0.90370177679937990D+00, 0.61175748451513070D+00
     5,  0.46269632891508080D+00, 0.37212681800161150D+00
     6,  0.31123914619848370D-00, 0.45366202969211280D+01
     7,  0.22510866298661310D+01, 0.15126102697764190D+01
     8,  0.11410577748312270D+01, 0.91658210248327360D+00
     9,  0.76609690554593660D+00, 0.93950709123011330D+01 /
      DATA  X2     /              0.42667001702876590D+01
     1,  0.28337513377435070D+01, 0.21292836450983810D+01
     2,  0.17073065310283440D+01, 0.14255975908036130D+01
     3,  0.D0                   , 0.70459054023934660D+01
     4,  0.45992276394183480D+01, 0.34370866338932070D+01
     5,  0.27491992553094320D+01, 0.22925620586321900D+01
     6,  0.D0                   , 0.10758516010180990D+02
     7,  0.68445254531151770D+01, 0.50780186145497680D+01
     8,  0.40489253138508870D+01, 0.33707742642089980D+01
     9,  0.D0                   , 0.15740678641278000D+02 /
      DATA  X3     /              0.96213168424568660D+01
     1,  0.70703385350482340D+01, 0.56151749708616170D+01
     2,  0.46650837034671710D+01, 0.D0
     3,  0.22863131736889260D+02, 0.13006054993306350D+02
     4,  0.94383143363919380D+01, 0.74590174536710630D+01
     5,  0.61815351187367650D+01, 0.D0
     6,  0.D0                   , 0.17116855187462260D+02
     7,  0.12214223368866160D+02, 0.95943928695810970D+01
     8,  0.79275392471721520D+01, 0.D0
     9,  0.D0                   , 0.22151090379397010D+02 /
      DATA  X4     /              0.15441527368781620D+02
     1,  0.12038802546964320D+02, 0.99120980150777060D+01
     2,  0.D0                   , 0.D0
     3,  0.28487967250984000D+02, 0.19180156856753140D+02
     4,  0.14814293442630740D+02, 0.12146102711729770D+02
     5,  0.D0                   , 0.D0
     6,  0.37099121044466920D+02, 0.23515905693991910D+02
     7,  0.17948895520519380D+02, 0.14642732289596670D+02
     8,  0.D0                   , 0.D0
     9,  0.D0                   , 0.28578729742882140D+02 /
      DATA  X5     /              0.21478788240285010D+02
     1,  0.17417992646508980D+02, 0.D0
     2,  0.D0                   , 0.D0
     3,  0.34583398702286630D+02, 0.25451702793186910D+02
     4,  0.20491460082616420D+02, 0.D0
     5,  0.D0                   , 0.D0
     6,  0.41940452647688330D+02, 0.29932554631700610D+02
     7,  0.23887329848169730D+02, 0.D0
     8,  0.D0                   , 0.D0
     9,  0.51701160339543320D+02, 0.35013434240479000D+02 /
      DATA  X6     /              0.27635937174332710D+02
     1,  0.D0                   , 0.D0
     2,  0.D0                   , 0.D0
     3,  0.40833057056728570D+02, 0.31776041352374720D+02
     4,  0.D0                   , 0.D0
     5,  0.D0                   , 0.D0
     6,  0.47619994047346500D+02, 0.36358405801651620D+02
     7,  0.D0                   , 0.D0
     8,  0.D0                   , 0.D0
     9,  0.55810795750063900D+02, 0.41451720484870770D+02 /
      DATA  X7     /              0.D0
     1,  0.D0                   , 0.D0
     2,  0.D0                   , 0.66524416525615750D+02
     3,  0.47153106445156320D+02, 0.D0
     4,  0.D0                   , 0.D0
     5,  0.D0                   , 0.D0
     6,  0.53608574544695060D+02, 0.D0
     7,  0.D0                   , 0.D0
     8,  0.D0                   , 0.D0
     9,  0.61058531447218760D+02, 0.D0                    /
      DATA  X8     /              0.D0
     1,  0.D0                   , 0.D0
     2,  0.D0                   , 0.69962240035105030D+02
     3,  0.D0                   , 0.D0
     4,  0.D0                   , 0.D0
     5,  0.D0                   , 0.81498279233948880D+02 /
      DATA  A1     /              0.60315410434163360D+00
     1,  0.36918858934163750D+00, 0.26473137105544320D+00
     2,  0.20615171495780100D+00, 0.16874680185111390D+00
     3,  0.14281197333478190D+00, 0.35741869243779970D+00
     4,  0.41878678081434300D+00, 0.37775927587313800D+00
     5,  0.33105785495088420D+00, 0.29125436200606830D+00
     6,  0.25877410751742390D+00, 0.38887908515005380D-01
     7,  0.17579498663717180D+00, 0.24408201131987760D+00
     8,  0.26579577764421410D+00, 0.26668610286700130D+00
     9,  0.25880670727286980D+00, 0.53929470556132740D-03 /
      DATA A2      /              0.33343492261215650D-01
     1,  0.90449222211680930D-01, 0.13629693429637750D+00
     2,  0.16600245326950680D+00, 0.18332268897777800D+00
     3,  0.D0                   , 0.27945362352256730D-02
     4,  0.20102381154634100D-01, 0.47328928694125220D-01
     5,  0.74826064668792370D-01, 0.98166272629918890D-01
     6,  0.D0                   , 0.90765087733582130D-04
     7,  0.26639735418653160D-02, 0.11299900080339450D-01
     8,  0.24964417309283220D-01, 0.40732478151408650D-01
     9,  0.D0                   , 0.84857467162725310D-06 /
      DATA  A3     /              0.20323159266299940D-03
     1,  0.18490709435263110D-02, 0.62025508445722370D-02
     2,  0.13226019405120160D-01, 0.D0
     3,  0.10480011748715100D-08, 0.83650558568197990D-05
     4,  0.20427191530827850D-03, 0.11449623864769080D-02
     5,  0.33693490584783040D-02, 0.D0
     6,  0.D0                   , 0.16684938765409100D-06
     7,  0.14844586873981300D-04, 0.15574177302781200D-03
     8,  0.67216256409354790D-03, 0.D0
     9,  0.D0                   , 0.13423910305150040D-08 /
      DATA  A4     /              0.68283193308712000D-06
     1,  0.15401440865224920D-04, 0.10446121465927520D-03
     2,  0.D0                   , 0.D0
     3,  0.30616016350350210D-11, 0.18810248410796730D-07
     4,  0.10864863665179820D-05, 0.12544721977993330D-04
     5,  0.D0                   , 0.D0
     6,  0.81480774674262420D-15, 0.28623502429738820D-09
     7,  0.53301209095567150D-07, 0.11513158127372800D-05
     8,  0.D0                   , 0.D0
     9,  0.D0                   , 0.21270790332241030D-11 /
      DATA  A5     /              0.17579811790505820D-08
     1,  0.79608129591336300D-07, 0.D0
     2,  0.D0                   , 0.D0
     3,  0.62979670025178680D-14, 0.37255024025123210D-10
     4,  0.40728589875500000D-08, 0.D0
     5,  0.D0                   , 0.D0
     6,  0.50504737000355130D-17, 0.47675292515781910D-12
     7,  0.15070082262925850D-09, 0.D0
     8,  0.D0                   , 0.D0
     9,  0.41614623703328550D-21, 0.33728442433624380D-14 /
      DATA  A6     /              0.39177365150584510D-11
     1,  0.D0                   , 0.D0
     2,  0.D0                   , 0.D0
     3,  0.11550143395003990D-16, 0.68941810529580860D-13
     4,  0.D0                   , 0.D0
     5,  0.D0                   , 0.D0
     6,  0.15395221405823440D-19, 0.78198003824594480D-15
     7,  0.D0                   , 0.D0
     8,  0.D0                   , 0.D0
     9,  0.52864427255691580D-23, 0.53501888130100380D-17 /
      DATA  A7     /              0.D0
     1,  0.D0                   , 0.D0
     2,  0.D0                   , 0.16564566124990230D-27
     3,  0.20105174645555030D-19, 0.D0
     4,  0.D0                   , 0.D0
     5,  0.D0                   , 0.D0
     6,  0.36057658645529590D-22, 0.D0
     7,  0.D0                   , 0.D0
     8,  0.D0                   , 0.D0
     9,  0.24518188458784030D-25, 0.D0                    /
      DATA  A8     /              0.D0
     1,  0.D0                   , 0.D0
     2,  0.D0                   , 0.40883015936806580D-29
     3,  0.D0                   , 0.D0
     4,  0.D0                   , 0.D0
     5,  0.D0                   , 0.55753457883283570D-34 /
!
      n=nX/4
      nX=4*n
      if(n.lt.1 .or. n.gt.6 ) Then
          Write (6,*) 'N/4 out of range :',n
          stop
      Endif
      do j=1,nX
        x_q(j)=X(n,j)
        w_q(j)=A(n,j)
      enddo
      Return
      End
